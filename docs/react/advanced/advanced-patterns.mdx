---
id: advanced-patterns
title: Advanced React Patterns
sidebar_position: 2
description: Master advanced React patterns including compound components, render props, HOCs, portals, and more for building flexible, reusable components.
keywords: [react patterns, compound components, render props, hoc, higher order components, react portals, advanced react]
---

# Advanced React Patterns

**Advanced patterns** help you build flexible, reusable, and maintainable React components. Learn industry-standard patterns used in production applications.

---

## üìå Why Learn Patterns?

Benefits:
- **Reusability** - Write once, use everywhere
- **Flexibility** - Adapt to different use cases
- **Maintainability** - Easier to understand and modify
- **Scalability** - Build complex UIs efficiently

---

## üî∏ Compound Components

### Basic Pattern

```jsx
function Tabs({ children }) {
  const [activeTab, setActiveTab] = useState(0);

  return (
    <div>
      {React.Children.map(children, (child, index) =>
        React.cloneElement(child, {
          isActive: index === activeTab,
          onSelect: () => setActiveTab(index)
        })
      )}
    </div>
  );
}

function Tab({ title, isActive, onSelect, children }) {
  return (
    <div>
      <button 
        onClick={onSelect}
      >
        {title}
      </button>
      {isActive && <div>{children}</div>}
    </div>
  );
}

// Usage
<Tabs>
  <Tab title="Tab 1">Content 1</Tab>
  <Tab title="Tab 2">Content 2</Tab>
  <Tab title="Tab 3">Content 3</Tab>
</Tabs>
```

### With Context

```jsx
const TabsContext = createContext();

function Tabs({ children }) {
  const [activeTab, setActiveTab] = useState(0);

  return (
    <TabsContext.Provider value={{ activeTab, setActiveTab }}>
      <div>{children}</div>
    </TabsContext.Provider>
  );
}

function TabList({ children }) {
  return <div>{children}</div>;
}

function Tab({ index, children }) {
  const { activeTab, setActiveTab } = useContext(TabsContext);
  
  return (
    <button
      onClick={() => setActiveTab(index)}
    >
      {children}
    </button>
  );
}

function TabPanels({ children }) {
  const { activeTab } = useContext(TabsContext);
  return <div>{children[activeTab]}</div>;
}

function TabPanel({ children }) {
  return <div>{children}</div>;
}

// Usage
<Tabs>
  <TabList>
    <Tab index={0}>Tab 1</Tab>
    <Tab index={1}>Tab 2</Tab>
  </TabList>
  <TabPanels>
    <TabPanel>Content 1</TabPanel>
    <TabPanel>Content 2</TabPanel>
  </TabPanels>
</Tabs>
```

---

## üî∏ Render Props

### Basic Pattern

```jsx
function MouseTracker({ render }) {
  const [position, setPosition] = useState({ x: 0, y: 0 });

  const handleMouseMove = (e) => {
    setPosition({ x: e.clientX, y: e.clientY });
  };

  return (
    <div onMouseMove={handleMouseMove}>
      {render(position)}
    </div>
  );
}

// Usage
<MouseTracker 
  render={({ x, y }) => (
    <h1>Mouse position: {x}, {y}</h1>
  )}
/>
```

### With Children Function

```jsx
function DataFetcher({ url, children }) {
  const [data, setData] = useState(null);
  const [loading, setLoading] = useState(true);

  useEffect(() => {
    fetch(url)
      .then(res => res.json())
      .then(data => {
        setData(data);
        setLoading(false);
      });
  }, [url]);

  return children({ data, loading });
}

// Usage
<DataFetcher url="/api/users">
  {({ data, loading }) => (
    loading ? <div>Loading...</div> : <div>{data.name}</div>
  )}
</DataFetcher>
```

---

## üî∏ Higher-Order Components (HOC)

### Basic HOC

```jsx
function withLoading(Component) {
  return function WithLoadingComponent({ isLoading, ...props }) {
    if (isLoading) {
      return <div>Loading...</div>;
    }
    return <Component {...props} />;
  };
}

// Usage
const UserListWithLoading = withLoading(UserList);

<UserListWithLoading isLoading={loading} users={users} />
```

### HOC with Props

```jsx
function withAuth(Component) {
  return function WithAuthComponent(props) {
    const { isAuthenticated, user } = useAuth();

    if (!isAuthenticated) {
      return <Navigate to="/login" />;
    }

    return <Component {...props} user={user} />;
  };
}

// Usage
const ProtectedDashboard = withAuth(Dashboard);
```

### Composing HOCs

```jsx
const enhance = compose(
  withAuth,
  withLoading,
  withErrorBoundary
);

const EnhancedComponent = enhance(MyComponent);
```

---

## üî∏ Portals

### Basic Portal

```jsx
import { createPortal } from 'react-dom';

function Modal({ children, isOpen }) {
  if (!isOpen) return null;

  return createPortal(
    <div>
      <div>
        {children}
      </div>
    </div>,
    document.body
  );
}

// Usage
<Modal isOpen={isOpen}>
  <h2>Modal Content</h2>
  <button onClick={() => setIsOpen(false)}>Close</button>
</Modal>
```

### Tooltip Portal

```jsx
function Tooltip({ children, content }) {
  const [isVisible, setIsVisible] = useState(false);
  const [position, setPosition] = useState({ x: 0, y: 0 });
  const ref = useRef(null);

  const handleMouseEnter = (e) => {
    const rect = e.target.getBoundingClientRect();
    setPosition({ x: rect.left, y: rect.bottom + 5 });
    setIsVisible(true);
  };

  return (
    <>
      <span
        ref={ref}
        onMouseEnter={handleMouseEnter}
        onMouseLeave={() => setIsVisible(false)}
      >
        {children}
      </span>
      
      {isVisible && createPortal(
        <div 
          style={{ left: position.x, top: position.y }}
        >
          {content}
        </div>,
        document.body
      )}
    </>
  );
}
```

---

## üî∏ Provider Pattern

### Custom Provider

```jsx
const ThemeContext = createContext();

function ThemeProvider({ children }) {
  const [theme, setTheme] = useState('light');

  const toggleTheme = () => {
    setTheme(prev => prev === 'light' ? 'dark' : 'light');
  };

  return (
    <ThemeContext.Provider value={{ theme, toggleTheme }}>
      {children}
    </ThemeContext.Provider>
  );
}

function useTheme() {
  const context = useContext(ThemeContext);
  if (!context) {
    throw new Error('useTheme must be used within ThemeProvider');
  }
  return context;
}

// Usage
<ThemeProvider>
  <App />
</ThemeProvider>
```

---

## üî∏ Container/Presentational Pattern

### Separation of Concerns

```jsx
// Container (Logic)
function UserListContainer() {
  const [users, setUsers] = useState([]);
  const [loading, setLoading] = useState(true);

  useEffect(() => {
    fetchUsers().then(data => {
      setUsers(data);
      setLoading(false);
    });
  }, []);

  const handleDelete = (id) => {
    setUsers(users.filter(u => u.id !== id));
  };

  return (
    <UserListPresentation 
      users={users}
      loading={loading}
      onDelete={handleDelete}
    />
  );
}

// Presentational (UI)
function UserListPresentation({ users, loading, onDelete }) {
  if (loading) return <div>Loading...</div>;

  return (
    <ul>
      {users.map(user => (
        <li key={user.id}>
          {user.name}
          <button onClick={() => onDelete(user.id)}>Delete</button>
        </li>
      ))}
    </ul>
  );
}
```

---

## üî∏ Controlled Props Pattern

### Flexible Component

```jsx
function Counter({ value, onChange, defaultValue = 0 }) {
  const [internalValue, setInternalValue] = useState(defaultValue);

  // Controlled or uncontrolled
  const isControlled = value !== undefined;
  const currentValue = isControlled ? value : internalValue;

  const handleIncrement = () => {
    const newValue = currentValue + 1;
    if (isControlled) {
      onChange?.(newValue);
    } else {
      setInternalValue(newValue);
    }
  };

  return (
    <div>
      <p>Count: {currentValue}</p>
      <button onClick={handleIncrement}>Increment</button>
    </div>
  );
}

// Controlled usage
<Counter value={count} onChange={setCount} />

// Uncontrolled usage
<Counter defaultValue={5} />
```

---

## üî∏ State Reducer Pattern

### Flexible State Management

```jsx
function useToggle(initialValue = false, reducer) {
  const [state, setState] = useState({ on: initialValue });

  const toggle = () => {
    const newState = { on: !state.on };
    const reducedState = reducer ? reducer(state, newState) : newState;
    setState(reducedState);
  };

  return [state.on, toggle];
}

// Custom reducer
const customReducer = (currentState, newState) => {
  // Add custom logic
  if (currentState.on && !newState.on) {
    console.log('Turning off');
  }
  return newState;
};

// Usage
const [isOn, toggle] = useToggle(false, customReducer);
```

---

## ‚úÖ Best Practices

### 1. **Choose the Right Pattern**

```jsx
// Simple state sharing ‚Üí Context API
// Reusable logic ‚Üí Custom Hooks
// Flexible components ‚Üí Compound Components
// Cross-cutting concerns ‚Üí HOCs
```

### 2. **Keep Components Simple**

```jsx
// ‚úÖ Good - Single responsibility
function UserProfile({ user }) {
  return <div>{user.name}</div>;
}

// ‚ùå Bad - Too many responsibilities
function UserProfile({ user, theme, auth, settings }) {
  // Too complex
}
```

### 3. **Document Patterns**

```jsx
/**
 * Tabs component using compound component pattern
 * @example
 * <Tabs>
 *   <Tab title="Tab 1">Content 1</Tab>
 * </Tabs>
 */
function Tabs({ children }) {
  // Implementation
}
```

---

## üö® Common Mistakes

### 1. **Overusing HOCs**

```jsx
// ‚ùå Bad - Too many HOCs
const Enhanced = withAuth(withTheme(withData(withLoading(Component))));

// ‚úÖ Good - Use hooks instead
function Component() {
  const auth = useAuth();
  const theme = useTheme();
  const data = useData();
  // ...
}
```

### 2. **Not Handling Edge Cases**

```jsx
// ‚ùå Bad - No null check
function useTheme() {
  return useContext(ThemeContext);
}

// ‚úÖ Good - Error handling
function useTheme() {
  const context = useContext(ThemeContext);
  if (!context) {
    throw new Error('useTheme must be used within ThemeProvider');
  }
  return context;
}
```

---

## üÜï React 19: Server Components

Server Components allow you to render components on the server, reducing client-side JavaScript.

### What Are Server Components?

- ‚úÖ **Rendered on server** - Execute on server, not client
- ‚úÖ **Zero JavaScript** - No JS sent to client
- ‚úÖ **Direct data access** - Access databases, APIs directly
- ‚úÖ **Better performance** - Smaller bundle sizes

### Basic Server Component

```jsx
// app/users/page.jsx (Next.js example)
// This is a Server Component by default

async function UsersPage() {
  // Direct database access - no API needed!
  const users = await db.users.findMany();

  return (
    <div>
      <h1>Users</h1>
      {users.map(user => (
        <div key={user.id}>
          <h2>{user.name}</h2>
          <p>{user.email}</p>
        </div>
      ))}
    </div>
  );
}

export default UsersPage;
```

### Client Components

Use `'use client'` directive for interactive components:

```jsx
'use client'; // This is a Client Component

import { useState } from 'react';

function Counter() {
  const [count, setCount] = useState(0);
  
  return (
    <button onClick={() => setCount(count + 1)}>
      Count: {count}
    </button>
  );
}
```

### Mixing Server and Client Components

```jsx
// Server Component
async function UserProfile({ userId }) {
  const user = await fetchUser(userId);
  
  return (
    <div>
      <h1>{user.name}</h1>
      <UserActions userId={userId} /> {/* Client Component */}
    </div>
  );
}

// Client Component
'use client';
function UserActions({ userId }) {
  const [liked, setLiked] = useState(false);
  
  return (
    <button onClick={() => setLiked(!liked)}>
      {liked ? '‚ù§Ô∏è' : 'ü§ç'}
    </button>
  );
}
```

### Benefits

- ‚úÖ **Smaller bundles** - Less JavaScript to download
- ‚úÖ **Faster initial load** - Content ready immediately
- ‚úÖ **Better SEO** - Fully rendered HTML
- ‚úÖ **Secure** - API keys stay on server

**Browser Support**: React 19+ (with Next.js 13+ or compatible framework)

### Partial Pre-rendering (React 19.2)

Pre-render static parts on the server while deferring dynamic components to the client.

```jsx
// Static parts rendered on server
function ProductPage({ productId }) {
  return (
    <div>
      {/* Static - pre-rendered */}
      <ProductHeader />
      <ProductDescription />
      
      {/* Dynamic - deferred to client */}
      <Suspense fallback={<Loading />}>
        <ProductReviews productId={productId} />
      </Suspense>
    </div>
  );
}
```

**Benefits:**
- ‚úÖ Faster initial load - static content ready immediately
- ‚úÖ Better SEO - static content fully rendered
- ‚úÖ Progressive enhancement - dynamic parts load as needed

### cacheSignal API (React 19.2)

Detect when cached fetch calls expire in Server Components.

```jsx
import { cacheSignal } from 'react';

async function fetchUserData(userId) {
  const signal = cacheSignal();
  
  const response = await fetch(`/api/users/${userId}`, {
    signal: signal.abort, // Abort if cache expires
  });
  
  // Cleanup when cache expires
  signal.addEventListener('abort', () => {
    console.log('Cache expired, cleaning up');
  });
  
  return response.json();
}
```

**Use Cases:**
- Cleanup fetch requests when cache expires
- Abort side effects when data no longer needed
- Resource management in Server Components

**Browser Support**: React 19.2+

### Batching Suspense Boundaries (React 19.2)

Multiple Suspense boundaries reveal together for smoother SSR.

```jsx
function App() {
  return (
    <div>
      {/* These boundaries batch together */}
      <Suspense fallback={<Loading1 />}>
        <Component1 />
      </Suspense>
      
      <Suspense fallback={<Loading2 />}>
        <Component2 />
      </Suspense>
      
      <Suspense fallback={<Loading3 />}>
        <Component3 />
      </Suspense>
    </div>
  );
}
```

**Benefits:**
- ‚úÖ Reduced flickering
- ‚úÖ Consistent server/client behavior
- ‚úÖ Better visual consistency

### Web Streams Integration (React 19.2)

Progressive rendering as content arrives from server.

```jsx
// Server-side streaming
async function* streamData() {
  for (const chunk of dataChunks) {
    yield chunk;
    await delay(100);
  }
}

function StreamingComponent() {
  return (
    <Suspense fallback={<Loading />}>
      <StreamedContent stream={streamData()} />
    </Suspense>
  );
}
```

**Benefits:**
- ‚úÖ Progressive content loading
- ‚úÖ Better performance on slow networks
- ‚úÖ Improved perceived performance

**Browser Support**: React 19.2+

---

## üìù Summary

- **Compound Components** - Flexible, composable APIs
- **Render Props** - Share logic via function props
- **HOCs** - Enhance components with additional props
- **Portals** - Render outside parent DOM
- **Provider Pattern** - Share state across tree
- **Container/Presentational** - Separate logic from UI
- **Controlled Props** - Flexible controlled/uncontrolled
- **State Reducer** - Customizable state logic
- Choose patterns based on **use case**
- **Document** your patterns well

---

## üîó Related Topics

- [Custom Hooks](../intermediate/custom-hooks)
- [Context API](../intermediate/context-api)
- [Performance Optimization](../intermediate/performance-optimization)
- [Components](../basics/components)

---

**Master these patterns to build professional React applications!** üöÄ
