---
id: custom-hooks
title: Custom Hooks
sidebar_position: 4
description:
  Learn how to create reusable custom hooks in React to share logic across
  components, including common patterns and best practices.
keywords:
  [
    react custom hooks,
    useHooks,
    reusable hooks,
    hook patterns,
    react hooks tutorial,
    custom react hooks,
  ]
---

# Custom Hooks in React

**Custom hooks** let you extract component logic into reusable functions. They
follow the same rules as built-in hooks and start with "use".

---

## üìå Why Custom Hooks?

Benefits:

- **Reuse logic** across components
- **Cleaner components** - separate concerns
- **Easier testing** - test logic independently
- **Better organization** - group related logic

---

## üî∏ Creating Custom Hooks

### Basic Custom Hook

```jsx
import { useState, useEffect } from 'react';

function useDocumentTitle(title) {
  useEffect(() => {
    document.title = title;
  }, [title]);
}

// Usage
function Page() {
  useDocumentTitle('My Page Title');
  return <div>Content</div>;
}
```

### Hook with Return Value

```jsx
function useToggle(initialValue = false) {
  const [value, setValue] = useState(initialValue);

  const toggle = () => setValue(prev => !prev);
  const setTrue = () => setValue(true);
  const setFalse = () => setValue(false);

  return [value, { toggle, setTrue, setFalse }];
}

// Usage
function Modal() {
  const [isOpen, { toggle, setTrue, setFalse }] = useToggle();

  return (
    <div>
      <button onClick={setTrue}>Open Modal</button>
      {isOpen && (
        <div>
          <button onClick={setFalse}>Close</button>
        </div>
      )}
    </div>
  );
}
```

---

## üî∏ Common Custom Hooks

### useLocalStorage

```jsx
function useLocalStorage(key, initialValue) {
  const [storedValue, setStoredValue] = useState(() => {
    try {
      const item = window.localStorage.getItem(key);
      return item ? JSON.parse(item) : initialValue;
    } catch (error) {
      console.error(error);
      return initialValue;
    }
  });

  const setValue = value => {
    try {
      const valueToStore =
        value instanceof Function ? value(storedValue) : value;
      setStoredValue(valueToStore);
      window.localStorage.setItem(key, JSON.stringify(valueToStore));
    } catch (error) {
      console.error(error);
    }
  };

  return [storedValue, setValue];
}

// Usage
function App() {
  const [name, setName] = useLocalStorage('name', '');

  return (
    <input
      value={name}
      onChange={e => setName(e.target.value)}
      placeholder="Your name"
    />
  );
}
```

### useFetch

```jsx
function useFetch(url) {
  const [data, setData] = useState(null);
  const [loading, setLoading] = useState(true);
  const [error, setError] = useState(null);

  useEffect(() => {
    const fetchData = async () => {
      try {
        setLoading(true);
        const response = await fetch(url);
        if (!response.ok) throw new Error('Network response was not ok');
        const json = await response.json();
        setData(json);
        setError(null);
      } catch (error) {
        setError(error.message);
        setData(null);
      } finally {
        setLoading(false);
      }
    };

    fetchData();
  }, [url]);

  return { data, loading, error };
}

// Usage
function UserProfile({ userId }) {
  const { data, loading, error } = useFetch(`/api/users/${userId}`);

  if (loading) return <div>Loading...</div>;
  if (error) return <div>Error: {error}</div>;

  return <div>{data.name}</div>;
}
```

### useDebounce

```jsx
function useDebounce(value, delay) {
  const [debouncedValue, setDebouncedValue] = useState(value);

  useEffect(() => {
    const handler = setTimeout(() => {
      setDebouncedValue(value);
    }, delay);

    return () => clearTimeout(handler);
  }, [value, delay]);

  return debouncedValue;
}

// Usage
function SearchBox() {
  const [searchTerm, setSearchTerm] = useState('');
  const debouncedSearchTerm = useDebounce(searchTerm, 500);

  useEffect(() => {
    if (debouncedSearchTerm) {
      // API call
      fetchResults(debouncedSearchTerm);
    }
  }, [debouncedSearchTerm]);

  return (
    <input value={searchTerm} onChange={e => setSearchTerm(e.target.value)} />
  );
}
```

### useWindowSize

```jsx
function useWindowSize() {
  const [windowSize, setWindowSize] = useState({
    width: window.innerWidth,
    height: window.innerHeight,
  });

  useEffect(() => {
    const handleResize = () => {
      setWindowSize({
        width: window.innerWidth,
        height: window.innerHeight,
      });
    };

    window.addEventListener('resize', handleResize);
    return () => window.removeEventListener('resize', handleResize);
  }, []);

  return windowSize;
}

// Usage
function ResponsiveComponent() {
  const { width } = useWindowSize();

  return <div>{width < 768 ? <MobileView /> : <DesktopView />}</div>;
}
```

### usePrevious

```jsx
function usePrevious(value) {
  const ref = useRef();

  useEffect(() => {
    ref.current = value;
  }, [value]);

  return ref.current;
}

// Usage
function Counter() {
  const [count, setCount] = useState(0);
  const prevCount = usePrevious(count);

  return (
    <div>
      <p>Current: {count}</p>
      <p>Previous: {prevCount}</p>
      <button onClick={() => setCount(count + 1)}>Increment</button>
    </div>
  );
}
```

### useOnClickOutside

```jsx
function useOnClickOutside(ref, handler) {
  useEffect(() => {
    const listener = event => {
      if (!ref.current || ref.current.contains(event.target)) {
        return;
      }
      handler(event);
    };

    document.addEventListener('mousedown', listener);
    document.addEventListener('touchstart', listener);

    return () => {
      document.removeEventListener('mousedown', listener);
      document.removeEventListener('touchstart', listener);
    };
  }, [ref, handler]);
}

// Usage
function Dropdown() {
  const [isOpen, setIsOpen] = useState(false);
  const dropdownRef = useRef(null);

  useOnClickOutside(dropdownRef, () => setIsOpen(false));

  return (
    <div ref={dropdownRef}>
      <button onClick={() => setIsOpen(!isOpen)}>Toggle</button>
      {isOpen && <div>Menu items...</div>}
    </div>
  );
}
```

### useInterval

```jsx
function useInterval(callback, delay) {
  const savedCallback = useRef();

  useEffect(() => {
    savedCallback.current = callback;
  }, [callback]);

  useEffect(() => {
    if (delay !== null) {
      const id = setInterval(() => savedCallback.current(), delay);
      return () => clearInterval(id);
    }
  }, [delay]);
}

// Usage
function Timer() {
  const [count, setCount] = useState(0);

  useInterval(() => {
    setCount(count + 1);
  }, 1000);

  return <div>Count: {count}</div>;
}
```

### useMediaQuery

```jsx
function useMediaQuery(query) {
  const [matches, setMatches] = useState(false);

  useEffect(() => {
    const media = window.matchMedia(query);
    if (media.matches !== matches) {
      setMatches(media.matches);
    }

    const listener = () => setMatches(media.matches);
    media.addEventListener('change', listener);

    return () => media.removeEventListener('change', listener);
  }, [matches, query]);

  return matches;
}

// Usage
function ResponsiveNav() {
  const isMobile = useMediaQuery('(max-width: 768px)');

  return isMobile ? <MobileNav /> : <DesktopNav />;
}
```

### useForm

```jsx
function useForm(initialValues) {
  const [values, setValues] = useState(initialValues);
  const [errors, setErrors] = useState({});

  const handleChange = e => {
    const { name, value } = e.target;
    setValues(prev => ({ ...prev, [name]: value }));
  };

  const handleSubmit = callback => e => {
    e.preventDefault();
    callback(values);
  };

  const reset = () => {
    setValues(initialValues);
    setErrors({});
  };

  return {
    values,
    errors,
    handleChange,
    handleSubmit,
    reset,
    setErrors,
  };
}

// Usage
function LoginForm() {
  const { values, handleChange, handleSubmit } = useForm({
    email: '',
    password: '',
  });

  const onSubmit = data => {
    console.log('Form data:', data);
  };

  return (
    <form onSubmit={handleSubmit(onSubmit)}>
      <input name="email" value={values.email} onChange={handleChange} />
      <input
        name="password"
        type="password"
        value={values.password}
        onChange={handleChange}
      />
      <button type="submit">Login</button>
    </form>
  );
}
```

---

## üî∏ Advanced Patterns

### Composing Hooks

```jsx
function useUser(userId) {
  const { data, loading, error } = useFetch(`/api/users/${userId}`);
  const [user, setUser] = useLocalStorage('user', null);

  useEffect(() => {
    if (data) {
      setUser(data);
    }
  }, [data, setUser]);

  return { user, loading, error };
}
```

### Hooks with Reducers

```jsx
function useAsync(asyncFunction) {
  const [state, dispatch] = useReducer(
    (state, action) => {
      switch (action.type) {
        case 'loading':
          return { ...state, loading: true, error: null };
        case 'success':
          return { loading: false, data: action.payload, error: null };
        case 'error':
          return { loading: false, data: null, error: action.payload };
        default:
          return state;
      }
    },
    { loading: false, data: null, error: null },
  );

  const execute = useCallback(
    async (...params) => {
      dispatch({ type: 'loading' });
      try {
        const data = await asyncFunction(...params);
        dispatch({ type: 'success', payload: data });
        return data;
      } catch (error) {
        dispatch({ type: 'error', payload: error });
        throw error;
      }
    },
    [asyncFunction],
  );

  return { ...state, execute };
}
```

---

## ‚úÖ Best Practices

### 1. **Name Hooks with "use" Prefix**

```jsx
// ‚úÖ Good
function useCounter() {}
function useFetch() {}

// ‚ùå Bad
function counter() {}
function fetchData() {}
```

### 2. **Follow Hook Rules**

```jsx
// ‚úÖ Good - Always at top level
function useCustomHook() {
  const [state, setState] = useState();
  useEffect(() => {}, []);
  return state;
}

// ‚ùå Bad - Conditional hooks
function useCustomHook(condition) {
  if (condition) {
    useState(); // Don't do this!
  }
}
```

### 3. **Return Consistent Values**

```jsx
// ‚úÖ Good - Array or object
function useToggle() {
  return [value, toggle];
}

function useFetch() {
  return { data, loading, error };
}
```

### 4. **Document Your Hooks**

```jsx
/**
 * Custom hook for managing form state
 * @param {Object} initialValues - Initial form values
 * @returns {Object} Form state and handlers
 */
function useForm(initialValues) {
  // Implementation
}
```

### 5. **Handle Cleanup**

```jsx
function useEventListener(eventName, handler, element = window) {
  useEffect(() => {
    element.addEventListener(eventName, handler);

    // Cleanup
    return () => {
      element.removeEventListener(eventName, handler);
    };
  }, [eventName, handler, element]);
}
```

---

## üö® Common Mistakes

### 1. **Not Following Hook Rules**

```jsx
// ‚ùå Wrong - Conditional hook
if (condition) {
  useEffect(() => {}, []);
}

// ‚úÖ Correct - Condition inside hook
useEffect(() => {
  if (condition) {
    // Do something
  }
}, [condition]);
```

### 2. **Missing Dependencies**

```jsx
// ‚ùå Wrong - Missing dependency
useEffect(() => {
  fetchData(userId);
}, []); // Missing userId!

// ‚úÖ Correct
useEffect(() => {
  fetchData(userId);
}, [userId]);
```

### 3. **Not Memoizing Callbacks**

```jsx
// ‚ùå Bad - New function every render
function useCustomHook() {
  const handleClick = () => {};
  return handleClick;
}

// ‚úÖ Good - Memoized
function useCustomHook() {
  const handleClick = useCallback(() => {}, []);
  return handleClick;
}
```

---

## üìù Summary

- **Custom hooks** extract reusable logic
- Start hook names with **"use"**
- Follow **hook rules** (top-level, consistent order)
- Return **arrays** or **objects**
- Handle **cleanup** in useEffect
- **Compose hooks** for complex logic
- **Document** your hooks
- Common patterns: **useFetch, useLocalStorage, useDebounce**

---

## üîó Related Topics

- [Hooks](./hooks)
- [Performance Optimization](./performance-optimization)
- [Context API](./context-api)
- [State](../basics/state)

---

**Create custom hooks to write cleaner, more reusable code!** üöÄ
